<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Diana Rune Calculator</title>
<style>
  :root{
    --bg:#0a0f1a; --card:rgba(12,18,30,0.8); --muted:#8b949e; --gold:#d8c48a;
  }
  body{margin:0;font-family:"Beaufort for LOL",serif;background:var(--bg);color:var(--gold);text-align:center;}
  header{font-size:36px;font-weight:700;padding:8px 0;}
  header::after{content:"";display:block;height:2px;background:var(--gold);margin-top:8px;width:100%;}
  .container{width:85%;max-width:980px;margin:18px auto 48px;}
  .calculate-btn{margin:20px auto;padding:12px 26px;font-weight:700;background:#2f81f7;color:#fff;border:none;border-radius:8px;cursor:pointer}
  .table-card{background:var(--card);border-radius:10px;padding:12px;margin-top:18px;color:#fff;}
  table{width:100%;border-collapse:collapse}
  th,td{padding:10px;text-align:left;border-bottom:1px solid rgba(255,255,255,0.04)}
  .card{background:var(--card);padding:16px;border-radius:10px;text-align:left;margin:0;}
  label{display:block;margin-bottom:8px;color:#fff}
  select,input[type=number]{width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:rgba(0,0,0,0.25);color:#fff;margin-bottom:14px}
  .section-title{font-weight:700;margin:12px 0 8px;text-align:left;color:var(--gold)}
  footer{color:var(--muted);text-align:center;padding:18px 0;margin-top:12px}

  /* Grid: desktop 2x2, mobile single column (DOM order preserved) */
  .grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    grid-template-rows: auto auto;
    gap:22px;
    grid-template-areas:
      "level enemy"
      "primary secondary";
  }

  #card-level{grid-area:level}
  #card-enemy{grid-area:enemy}
  #card-primary{grid-area:primary}
  #card-secondary{grid-area:secondary}

  @media (max-width:700px){
    .grid{grid-template-columns:1fr;grid-template-areas: none;} /* fall back to DOM order */
  }

  /* keep consistent spacing so desktop visuals remain identical to your preferred version */
  .grid > div{min-height:0}
</style>
</head>
<body>
<header>DIANA RUNE CALCULATOR</header>
<div class="container">

  <div class="grid">
    <!-- DOM order chosen so mobile stacks: Level -> Enemy -> Primary -> Secondary -->
    <div id="card-level" class="card">
      <div class="section-title">DIANA'S LEVEL</div>
      <label for="diana-level">Level</label>
      <select id="diana-level"></select>
    </div>

    <div id="card-enemy" class="card">
      <div class="section-title">ENEMY STATS</div>
      <label for="enemy-hp">HP (target max HP)</label>
      <input id="enemy-hp" type="number" value="600">
      <label for="enemy-armor">Armor</label>
      <input id="enemy-armor" type="number" value="30">
      <label for="enemy-mr">MR</label>
      <input id="enemy-mr" type="number" value="30">
    </div>

    <div id="card-primary" class="card">
      <div class="section-title">PRIMARY RUNES</div>
      <label for="primary-path">Primary Path</label>
      <select id="primary-path" aria-label="Primary Path">
        <option value="domination">Domination</option>
        <option value="sorcery">Sorcery</option>
        <option value="precision">Precision</option>
        <option value="resolve">Resolve</option>
        <option value="inspiration">Inspiration</option>
      </select>

      <label for="primary-slot-1">Slot 1 (Keystone)</label>
      <select id="primary-slot-1"></select>

      <label for="primary-slot-2">Slot 2</label>
      <select id="primary-slot-2"></select>

      <label for="primary-slot-3">Slot 3</label>
      <select id="primary-slot-3"></select>

      <label for="primary-slot-4">Slot 4</label>
      <select id="primary-slot-4"></select>
    </div>

    <div id="card-secondary" class="card">
      <div class="section-title">SECONDARY RUNES</div>
      <label for="secondary-path">Secondary Path (must differ from primary)</label>
      <select id="secondary-path" aria-label="Secondary Path">
        <option value="sorcery">Sorcery</option>
        <option value="precision">Precision</option>
        <option value="resolve">Resolve</option>
        <option value="inspiration">Inspiration</option>
        <option value="domination">Domination</option>
      </select>

      <label for="secondary-slot-1">Slot 1</label>
      <select id="secondary-slot-1"></select>

      <label for="secondary-slot-2">Slot 2</label>
      <select id="secondary-slot-2"></select>
    </div>
  </div>

  <button id="calculate-btn" class="calculate-btn">Calculate Damage</button>

  <div class="table-card">
    <table aria-label="Rune damage table">
      <thead>
        <tr><th>Rune</th><th>Estimated Damage</th><th>Damage Type</th></tr>
      </thead>
      <tbody id="rune-damage-table">
        <tr><td colspan="3" style="text-align:center;color:var(--muted)">No calculation yet — click Calculate</td></tr>
      </tbody>
    </table>
  </div>
</div>

<footer>© 2025 LoL Fundamentals · All rights reserved</footer>

<script>
/* ---------- Rune meta ---------- */
const RUNE_META = {
  // min/max used for linear scaling level1..18
  "Electrocute": { type:"Magic", min:70, max:240, apRatio:0.5 },
  "Cheap Shot":  { type:"True", min:10, max:45, special:"cheap" },
  "Aery":        { type:"Magic", min:10, max:50, apRatio:0.005 },
  "Comet":       { type:"Magic", min:10, max:50, apRatio:0.005 },
  "Scorch":      { type:"Magic", min:20, max:40 },
  "Grasp of the Undying": { type:"Magic", special:"grasp" }, // 3.5% max HP (magic)
  "Shield Bash": { type:"Magic", special:"shieldbash" }     // base 5->30 + 2.5% bonusHP + 15% shield
};

/* Primary (keystones allowed) */
const PRIMARY_PATHS = {
  domination: {
    slot1:["Electrocute","Hail of Blades","Dark Harvest"],
    slot2:["Cheap Shot","Taste of Blood","Sudden Impact"],
    slot3:["Sixth Sense","Grisly Memories","Null"],
    slot4:["Treasure Hunter","Relentless Hunter","Ultimate Hunter"]
  },
  sorcery: {
    slot1:["Aery","Comet","Phase Rush"],
    slot2:["Nimbus Cloak","Manaflow Band","Transcendence"],
    slot3:["Celerity","Scorch","Waterwalking"],
    slot4:["Gathering Storm","Null","Null"]
  },
  precision: {
    slot1:["Press the Attack","Lethal Tempo","Fleet Footwork"],
    slot2:["Presence of Mind","Triumph","Coup de Grace"],
    slot3:["Legend: Alacrity","Legend: Tenacity","Cut Down"],
    slot4:["Last Stand","Null","Null"]
  },
  resolve: {
    slot1:["Grasp of the Undying","Aftershock","Guardian"],
    slot2:["Shield Bash","Font of Life","Conditioning"],
    slot3:["Second Wind","Bone Plating","Overgrowth"],
    slot4:["Revitalize","Null","Null"]
  },
  inspiration: {
    slot1:["Glacial Augment","Unsealed Spellbook","First Strike"],
    slot2:["Hextech Flashtraption","Magical Footwear","Future's Market"],
    slot3:["Minion Dematerializer","Biscuit Delivery","Cosmic Insight"],
    slot4:["Approach Velocity","Time Warp Tonic","Null"]
  }
};

/* Secondary (non-keystone only) — ensure Sorcery list has no Domination runes */
const SECONDARY_NONKEY = {
  sorcery: ["Manaflow Band","Transcendence","Celerity","Scorch","Waterwalking","Gathering Storm","Nimbus Cloak","Null","Null"],
  precision: ["Presence of Mind","Triumph","Coup de Grace","Legend: Alacrity","Legend: Tenacity","Cut Down","Last Stand","Null","Null"],
  resolve: ["Demolish","Font of Life","Conditioning","Second Wind","Bone Plating","Overgrowth","Revitalize","Null","Null"],
  inspiration: ["Hextech Flashtraption","Magical Footwear","Future's Market","Minion Dematerializer","Biscuit Delivery","Cosmic Insight","Approach Velocity","Time Warp Tonic","Unsealed Spellbook"],
  domination: ["Cheap Shot","Taste of Blood","Sudden Impact","Sixth Sense","Grisly Memories","Treasure Hunter","Relentless Hunter","Ultimate Hunter","Null"]
};

/* ---------- Helpers ---------- */
function scale(min,max,level){ return Math.round(min + (max-min)*(level-1)/17); }
function magicMitigate(raw,mr){ return Math.round(raw*100/(100+mr)); }

/* populate utilities */
function fillSelect(el, items){
  el.innerHTML = "";
  items.forEach(it => {
    const o = document.createElement("option"); o.value = it; o.textContent = it; el.appendChild(o);
  });
}

/* init level */
function initLevel(){
  const s = document.getElementById("diana-level");
  for(let i=1;i<=18;i++){ const o=document.createElement("option"); o.value=i; o.textContent=i; s.appendChild(o); }
  s.value = 1;
}

/* populate primary/secondary */
function populatePrimary(path){
  const p = PRIMARY_PATHS[path];
  fillSelect(document.getElementById("primary-slot-1"), p.slot1);
  fillSelect(document.getElementById("primary-slot-2"), p.slot2);
  fillSelect(document.getElementById("primary-slot-3"), p.slot3);
  fillSelect(document.getElementById("primary-slot-4"), p.slot4);
}
function populateSecondary(path){
  const arr = SECONDARY_NONKEY[path] || [];
  fillSelect(document.getElementById("secondary-slot-1"), arr);
  fillSelect(document.getElementById("secondary-slot-2"), arr);
  // default for sorcery
  if(path==="sorcery"){
    document.getElementById("secondary-slot-1").value = "Manaflow Band";
    document.getElementById("secondary-slot-2").value = "Transcendence";
  } else {
    // pick first two values if available (skip "Null")
    document.getElementById("secondary-slot-1").value = arr[0] || "";
    document.getElementById("secondary-slot-2").value = arr[1] || "";
  }
}

/* ensure secondary path differs from primary */
function enforceDifferentPaths(){
  const prim = document.getElementById("primary-path").value;
  const sec = document.getElementById("secondary-path");
  for(let i=0;i<sec.options.length;i++){
    sec.options[i].disabled = (sec.options[i].value === prim);
  }
  if(sec.value === prim){
    for(let i=0;i<sec.options.length;i++){
      if(!sec.options[i].disabled){ sec.selectedIndex = i; break; }
    }
  }
}

/* damage calculators */
function calcCheap(level){ return scale(10,45,level); }
function calcScaledRune(name, level, ap, mr){
  const meta = RUNE_META[name];
  if(!meta) return 0;
  if(meta.min !== undefined){
    const raw = scale(meta.min, meta.max, level) + Math.round((meta.apRatio||0) * ap);
    return magicMitigate(raw, mr);
  }
  return 0;
}
function calcGrasp(enemyHp){ return Math.round(0.035 * enemyHp); }
function calcShieldBash(level, bonusHP=0, shieldAmt=0){
  const base = scale(5,30,level);
  const fromBonus = Math.round(0.025 * bonusHP);
  const fromShield = Math.round(0.15 * shieldAmt);
  return base + fromBonus + fromShield;
}

/* main calculate */
function calculateDamage(){
  const level = parseInt(document.getElementById("diana-level").value,10);
  const enemyMR = parseFloat(document.getElementById("enemy-mr").value) || 30;
  const enemyHP = parseFloat(document.getElementById("enemy-hp").value) || 600;
  const ap = Math.round(level * 5);

  const slots = [
    document.getElementById("primary-slot-1").value,
    document.getElementById("primary-slot-2").value,
    document.getElementById("primary-slot-3").value,
    document.getElementById("primary-slot-4").value,
    document.getElementById("secondary-slot-1").value,
    document.getElementById("secondary-slot-2").value
  ];

  const tbody = document.getElementById("rune-damage-table");
  tbody.innerHTML = "";

  slots.forEach(rune => {
    let dmg = 0;
    let type = "";

    if(!rune || rune === "Null"){ dmg = 0; type = ""; }
    else if(rune === "Cheap Shot"){ dmg = calcCheap(level); type = "True"; }
    else if(rune === "Aery" || rune === "Comet"){ 
      const raw = scale(RUNE_META[rune].min, RUNE_META[rune].max, level) + Math.round((RUNE_META[rune].apRatio||0)*ap);
      dmg = magicMitigate(raw, enemyMR); type = "Magic";
    }
    else if(rune === "Scorch"){
      const raw = scale(RUNE_META["Scorch"].min, RUNE_META["Scorch"].max, level);
      dmg = magicMitigate(raw, enemyMR); type = "Magic";
    }
    else if(rune === "Electrocute"){
      const raw = scale(RUNE_META["Electrocute"].min, RUNE_META["Electrocute"].max, level) + Math.round((RUNE_META["Electrocute"].apRatio||0)*ap);
      dmg = magicMitigate(raw, enemyMR); type = "Magic";
    }
    else if(rune === "Grasp of the Undying"){
      dmg = calcGrasp(enemyHP); type = "Magic";
    }
    else if(rune === "Shield Bash"){
      // bonusHP and shield amount default 0 per your request
      dmg = calcShieldBash(level, 0, 0); type = "Magic";
    } else {
      // default: non-damaging utility runes show 0 with blank type
      dmg = 0; type = "";
    }

    const tr = document.createElement("tr");
    const runeName = document.createElement("td"); runeName.textContent = rune;
    const dmgTd = document.createElement("td"); dmgTd.textContent = dmg;
    const typeTd = document.createElement("td"); typeTd.textContent = type;
    tr.appendChild(runeName); tr.appendChild(dmgTd); tr.appendChild(typeTd);
    tbody.appendChild(tr);
  });
}

/* ---------- Init wiring ---------- */
document.addEventListener("DOMContentLoaded", () => {
  initLevel();

  // Make sure secondary path defaults to sorcery and its dropdown is correct
  document.getElementById("secondary-path").value = "sorcery";

  populatePrimary(document.getElementById("primary-path").value);
  populateSecondary(document.getElementById("secondary-path").value);
  enforceDifferentPaths();

  // Event listeners
  document.getElementById("primary-path").addEventListener("change", (e) => {
    populatePrimary(e.target.value);
    enforceDifferentPaths();
  });
  document.getElementById("secondary-path").addEventListener("change", (e) => {
    populateSecondary(e.target.value);
    enforceDifferentPaths();
  });
  document.getElementById("calculate-btn").addEventListener("click", calculateDamage);

  // Final safety defaults in case earlier steps didn't set them
  if(!document.getElementById("secondary-slot-1").value) document.getElementById("secondary-slot-1").value = "Manaflow Band";
  if(!document.getElementById("secondary-slot-2").value) document.getElementById("secondary-slot-2").value = "Transcendence";
});
</script>
</body>
</html>


