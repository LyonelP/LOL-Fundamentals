<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Diana Combo Calculator with Pen</title>
<style>
body { margin:0; padding:0; font-family:"Beaufort for LOL", serif; background:#0a0f1a; color:#d8c48a; text-align:center; }
header { font-size:36px; font-weight:700; padding:5px 0; letter-spacing:2px; }
header::after { content:""; display:block; width:100%; height:2px; background:#d8c48a; margin-top:10px; }
.container { width:85%; max-width:900px; margin:20px auto; }
.card { background:rgba(12,18,30,0.8); border:1px solid rgba(255,255,255,0.08); padding:16px 20px; border-radius:10px; text-align:left; margin-bottom:20px; }
.card label { display:block; margin-bottom:8px; font-size:16px; }
select,input[type=number] { width:100%; padding:10px; margin-bottom:16px; border-radius:8px; border:1px solid rgba(255,255,255,0.08); background:rgba(15,22,35,0.9); color:white; font-size:16px; }
button { padding:12px 26px; font-size:16px; font-weight:bold; background:#2f81f7; color:#fff; border:none; border-radius:8px; cursor:pointer; }
button:hover { background:#1b5fc7; }
table { width:100%; border-collapse:collapse; margin-top:10px; }
th,td { padding:12px; border-bottom:1px solid rgba(255,255,255,0.05); }
th { color:#d8c48a; font-size:16px; }
td { color:white; font-size:15px; }
footer { text-align:center; margin-top:40px; padding:15px 0; color:#8b949e; font-size:14px; }
</style>
</head>
<body>

<header>DIANA COMBO CALCULATOR</header>

<div class="container">

<div class="card">
  <label>Diana Level</label>
  <select id="diana-level"></select>
  <label>Enemy HP</label>
  <input type="number" id="enemy-hp" value="1000">
  <label>Enemy MR</label>
  <input type="number" id="enemy-mr" value="30">
</div>

<div class="card">
  <label>AP Items (6 slots)</label>
  <select id="item-1"></select>
  <select id="item-2"></select>
  <select id="item-3"></select>
  <select id="item-4"></select>
  <select id="item-5"></select>
  <select id="item-6"></select>
</div>

<div class="card">
  <label>Ability Usage</label>
  <label>Passive uses</label>
  <input type="number" id="passive-count" value="1">
  <label>Q uses (1-5 rank)</label>
  <input type="number" id="q-count" value="1" min="1" max="5">
  <label>W uses (1-5 rank)</label>
  <input type="number" id="w-count" value="1" min="1" max="5">
  <label>E uses (1-5 rank)</label>
  <input type="number" id="e-count" value="1" min="1" max="5">
  <label>R uses (1-3 rank)</label>
  <input type="number" id="r-count" value="1" min="1" max="3">
</div>

<button id="calculate-btn">Calculate Combo Damage</button>

<div class="card">
  <table>
    <thead>
      <tr><th>Ability</th><th>Total Damage</th><th>Damage Type</th></tr>
    </thead>
    <tbody id="damage-table">
      <tr><td>—</td><td>—</td><td>—</td></tr>
      <tr><td>—</td><td>—</td><td>—</td></tr>
      <tr><td>—</td><td>—</td><td>—</td></tr>
      <tr><td>—</td><td>—</td><td>—</td></tr>
      <tr><td>—</td><td>—</td><td>—</td></tr>
    </tbody>
  </table>
</div>

</div>

<footer>© 2025 LoL Fundamentals · All rights reserved</footer>

<script>
// Items list with AP, flat pen, percent pen
const AP_ITEMS = [
  {name:"Amplifying Tome", ap:20, flatPen:0, percPen:0},
  {name:"Lost Chapter", ap:40, flatPen:0, percPen:0},
  {name:"Needlessly Large Rod", ap:60, flatPen:0, percPen:0},
  {name:"Fiendish Codex", ap:30, flatPen:0, percPen:0},
  {name:"Blasting Wand", ap:40, flatPen:0, percPen:0},
  {name:"Hextech Rocketbelt", ap:90, flatPen:0, percPen:0},
  {name:"Luden's Tempest", ap:120, flatPen:0, percPen:0},
  {name:"Night Harvester", ap:100, flatPen:0, percPen:0},
  {name:"Shadowflame", ap:100, flatPen:15, percPen:0},
  {name:"Rabadon's Deathcap", ap:150, flatPen:0, percPen:0},
  {name:"Void Staff", ap:90, flatPen:0, percPen:0.4},
  {name:"Horizon Focus", ap:100, flatPen:0, percPen:0},
  {name:"Liandry's Anguish", ap:90, flatPen:0, percPen:0},
  {name:"Demonic Embrace", ap:80, flatPen:0, percPen:0},
  {name:"Morellonomicon", ap:70, flatPen:0, percPen:0},
  {name:"Cryptbloom", ap:80, flatPen:0, percPen:0.3},
  {name:"Stormsurge", ap:80, flatPen:15, percPen:0},
  {name:"Bloodletter's Curse", ap:60, flatPen:10, percPen:0.1}
];

// Populate item slots
function populateItems() {
  for(let i=1;i<=6;i++){
    const select=document.getElementById(`item-${i}`);
    AP_ITEMS.forEach((it, idx)=>{
      const o=document.createElement("option");
      o.value=idx;
      o.textContent=it.name;
      select.appendChild(o);
    });
  }
}

// Populate Diana levels
function populateLevels(){
  const lvl=document.getElementById("diana-level");
  for(let i=1;i<=18;i++){
    const o=document.createElement("option"); o.value=i; o.textContent=i;
    lvl.appendChild(o);
  }
  lvl.value=1;
}

// Get total AP, flat pen, percent pen
function getItemStats(){
  let totalAP=0, flatPen=0, percPen=0;
  for(let i=1;i<=6;i++){
    const idx = parseInt(document.getElementById(`item-${i}`).value);
    const item = AP_ITEMS[idx] || {ap:0, flatPen:0, percPen:0};
    totalAP += item.ap;
    flatPen += item.flatPen;
    percPen += item.percPen;
  }
  return {totalAP, flatPen, percPen};
}

// Diana ability bases
function getPassiveBase(level){ return Math.round(20 + (220-20)*(level-1)/17); }
const Q_BASE=[70,105,140,175,210], Q_RATIO=0.7;
const W_BASE=[60,96,132,168,204], W_RATIO=0.54;
const E_BASE=[50,70,90,110,130], E_RATIO=0.6;
const R_BASE=[200,300,400], R_RATIO=0.6;

// Damage calculation applying flat + % pen
function calcDamage(base, ratio, ap, mr, count, flatPen, percPen){
  let raw = (base + ratio*ap) * count;
  let effectiveMR = mr - flatPen;
  if(effectiveMR < 0) effectiveMR = 0;
  effectiveMR = effectiveMR * (1 - percPen);
  const dmg = Math.round(raw * 100 / (100 + effectiveMR));
  return dmg;
}

function calculateCombo(){
  const level = parseInt(document.getElementById("diana-level").value);
  const mr = parseFloat(document.getElementById("enemy-mr").value)||30;

  const passiveCount = parseInt(document.getElementById("passive-count").value)||0;
  const qRank = parseInt(document.getElementById("q-count").value)||1;
  const wRank = parseInt(document.getElementById("w-count").value)||1;
  const eRank = parseInt(document.getElementById("e-count").value)||1;
  const rRank = parseInt(document.getElementById("r-count").value)||1;

  const {totalAP, flatPen, percPen} = getItemStats();

  const abilities = [
    {name:"Passive", base:getPassiveBase(level), ratio:0.5, count:passiveCount},
    {name:"Q", base:Q_BASE[qRank-1]||Q_BASE[0], ratio:Q_RATIO, count:1},
    {name:"W", base:W_BASE[wRank-1]||W_BASE[0], ratio:W_RATIO, count:1},
    {name:"E", base:E_BASE[eRank-1]||E_BASE[0], ratio:E_RATIO, count:1},
    {name:"R", base:R_BASE[rRank-1]||R_BASE[0], ratio:R_RATIO, count:1}
  ];

  const tbody = document.getElementById("damage-table");
  tbody.innerHTML="";
  abilities.forEach(ab=>{
    const dmg = calcDamage(ab.base, ab.ratio, totalAP, mr, ab.count, flatPen, percPen);
    const row = document.createElement("tr");
    row.innerHTML=`<td>${ab.name}</td><td>${dmg}</td><td>Magic</td>`;
    tbody.appendChild(row);
  });
}

document.addEventListener("DOMContentLoaded",()=>{
  populateItems();
  populateLevels();
  document.getElementById("calculate-btn").addEventListener("click",calculateCombo);
});
</script>

</body>
</html>


